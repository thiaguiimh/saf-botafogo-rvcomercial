<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suíte de Comissões</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --background-color: #f8f9fa;
            --card-background: #ffffff;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --accent-blue: #007bff;
            --border-color: #dee2e6;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--background-color); color: var(--text-primary); }
        .card { background: var(--card-background); border-radius: 0.75rem; border: 1px solid var(--border-color); padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .nav-link { padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 500; cursor: pointer; transition: all 0.2s; color: var(--text-secondary); }
        .nav-link.active { background-color: var(--accent-blue); color: white; }
        .btn { padding: 0.6rem 1.2rem; border-radius: 0.5rem; font-weight: 500; transition: all 0.2s; border: none; cursor: pointer; display: inline-flex; align-items: center; justify-content: center;}
        .btn:disabled { background-color: #6c757d; cursor: not-allowed; }
        .btn-primary { background-color: var(--accent-blue); color: white; }
        .btn-primary:hover:not(:disabled) { background-color: #0069d9; }
        .btn-danger-sm { background-color: #dc3545; color: white; padding: 0.25rem 0.5rem; font-size: 0.75rem; border-radius: 0.25rem;}
        .btn-edit-sm { background-color: #6c757d; color: white; padding: 0.25rem 0.5rem; font-size: 0.75rem; border-radius: 0.25rem;}
        .form-input { width: 100%; padding: 0.6rem 0.8rem; border: 1px solid #ced4da; border-radius: 0.375rem; background-color: #fff; }
        .table-container { max-height: 280px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 0.5rem;}
        .table thead th { text-align: left; padding: 0.75rem; font-weight: 600; background-color: #f8f9fa; position: sticky; top: 0; font-size: 0.8rem; border-bottom: 2px solid var(--border-color); }
        .table tbody td { padding: 0.75rem; border-bottom: 1px solid #f0f0f0; vertical-align: middle; }
        .loader { border: 3px solid #dee2e6; border-top: 3px solid var(--accent-blue); border-radius: 50%; width: 30px; height: 30px; animation: spin 0.8s linear infinite; }
        .loader-sm { width: 16px; height: 16px; border-width: 2px; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display:flex; align-items:center; justify-content:center; z-index: 50; padding: 1rem;}
        .modal-content { background: white; padding: 1.5rem; border-radius: 0.75rem; width: 100%; max-width: 800px; max-height: 90vh; overflow-y: auto;}
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="p-4">
    <div id="app" class="min-h-screen"></div>
    <div id="modal-container" class="hidden"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, doc, addDoc, setDoc, deleteDoc, onSnapshot, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAs9tsz3wsSjYlmbu8_7NnEbKxqsFV2ATo",
            authDomain: "rvcomercial-fc7c9.firebaseapp.com",
            projectId: "rvcomercial-fc7c9",
            storageBucket: "rvcomercial-fc7c9.appspot.com",
            messagingSenderId: "373252435120",
            appId: "1:373252435120:web:817b4e65f46a2a572adf75"
        };
        
        const appEl = document.getElementById('app');
        const modalContainer = document.getElementById('modal-container');
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let state = {
            currentUser: null, userProfile: null, employees: [], contracts: [], commissionModels: [], users: [],
            currentView: 'loading', unsubscribe: [],
        };
        
        const usersCol = collection(db, "users");
        const employeesCol = collection(db, "employees");
        const contractsCol = collection(db, "contracts");
        const commissionModelsCol = collection(db, "commissionModels");

        onAuthStateChanged(auth, async (user) => {
            state.unsubscribe.forEach(unsub => unsub());
            state = { ...state, currentUser: user, userProfile: null, employees: [], contracts: [], commissionModels: [], users:[], unsubscribe: [], currentView: 'loading' };

            if (user) {
                try {
                    const userDocSnap = await getDoc(doc(db, "users", user.uid));
                    if (userDocSnap.exists()) {
                        state.userProfile = { id: user.uid, ...userDocSnap.data() };
                        initializeDataListeners();
                    } else { throw new Error("Perfil de usuário não encontrado. Contate o administrador."); }
                } catch (error) {
                    alert(error.message);
                    await signOut(auth);
                }
            } else {
                state.currentView = 'login';
                render();
            }
        });
        
        function initializeDataListeners() {
            let loaded = 0;
            const collectionsToLoad = state.userProfile?.isAdmin ? 4 : 3;

            const onDataLoad = () => {
                loaded++;
                if (loaded === collectionsToLoad) {
                    if (state.userProfile.isAdmin) state.currentView = 'admin';
                    else if (state.userProfile.isManager) state.currentView = 'gestor';
                    else state.currentView = 'funcionario';
                    render();
                }
            };

            const collections = { employees: employeesCol, contracts: contractsCol, commissionModels: commissionModelsCol };
            if (state.userProfile?.isAdmin) collections.users = usersCol;

            for (const key in collections) {
                const unsub = onSnapshot(collections[key], snapshot => {
                    state[key] = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));
                    onDataLoad();
                }, error => console.error(`Error listening to ${key}:`, error));
                state.unsubscribe.push(unsub);
            }
        }
        
        function render() {
            const viewRenderers = {
                loading: () => `<div class="flex items-center justify-center h-screen"><div class="loader"></div></div>`,
                login: renderLogin,
                admin: renderAdminDashboard,
                gestor: renderGestorDashboard,
                funcionario: renderFuncionarioDashboard,
            };
            appEl.innerHTML = (viewRenderers[state.currentView] || viewRenderers.login)();
            attachEventListeners();
        }

        const formatCurrency = (v) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(v || 0);
        const formatDate = (d) => d ? new Date(d + 'T00:00:00').toLocaleDateString('pt-BR') : 'N/A';
        const formatPercent = (v) => isNaN(v) ? '0,000%' : new Intl.NumberFormat('pt-BR', { style: 'percent', minimumFractionDigits: 3, maximumFractionDigits: 3 }).format(v || 0);
        
        function openModal(title, formHtml) {
             modalContainer.innerHTML = `<div class="modal-overlay"><div class="modal-content">
                <div class="flex justify-between items-center mb-4"><h3 class="text-lg font-semibold">${title}</h3><button id="closeModalBtn" class="font-bold text-xl">×</button></div>
                <div id="modalFormContainer">${formHtml}</div>
             </div></div>`;
             modalContainer.classList.remove('hidden');
             document.getElementById('closeModalBtn').addEventListener('click', closeModal);
             modalContainer.querySelector('.modal-overlay').addEventListener('click', e => e.target === e.currentTarget && closeModal());
        }
        function closeModal() { modalContainer.innerHTML = ''; modalContainer.classList.add('hidden'); }
        
        function renderHeader(title, navHtml = '') {
            return `<header class="bg-white shadow-sm border-b p-4 sticky top-0 z-40 mb-6">
                <div class="container mx-auto flex justify-between items-center">
                    <h1 class="text-xl font-semibold">${title}</h1>
                    <div class="flex items-center gap-4">
                        ${navHtml}
                        <button id="logoutBtn" class="btn btn-primary text-sm">Sair</button>
                    </div>
                </div></header>`;
        }

        function renderLogin() {
            return `<div class="flex items-center justify-center min-h-screen"><div class="card w-full max-w-sm">
            <h1 class="text-xl font-semibold text-center mb-4">Acesso ao Portal de Comissões</h1><form id="loginForm" class="space-y-4">
            <input id="email" type="email" placeholder="Email" class="form-input" required><input id="password" type="password" placeholder="Senha" class="form-input" required>
            <button type="submit" class="btn btn-primary w-full">Entrar</button></form></div></div>`;
        }

        // --- ADMIN DASHBOARD & COMPONENTS ---
        function renderAdminDashboard() {
            return `${renderHeader('Painel Administrativo')}
                <main class="container mx-auto grid grid-cols-1 lg:grid-cols-2 gap-6">
                    ${renderAdminCard('Usuários', renderAdminUserTable())}
                    ${renderAdminCard('Funcionários', renderAdminEmployeeTable())}
                    ${renderAdminCard('Contratos', renderAdminContractTable())}
                    ${renderAdminCard('Modelos de Comissão', renderAdminCommissionModelTable())}
                </main>`;
        }
        function renderAdminCard(title, tableHtml) {
            const typeMap = {'Usuários': 'user', 'Funcionários': 'employee', 'Contratos': 'contract', 'Modelos de Comissão': 'commissionModel'};
            return `<div class="card"><div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold">${title}</h2>
                <button class="btn-add-item text-sm btn btn-primary" data-type="${typeMap[title]}">Adicionar</button>
            </div><div class="table-container">${tableHtml}</div></div>`;
        }
        
        function renderAdminUserTable() {
             return `<table class="w-full text-sm table"><tbody>
                ${state.users.map(u => `<tr><td><div class="font-semibold">${u.name}</div><div class="text-xs text-gray-500">${u.email}</div></td><td class="text-right space-x-2"><button class="btn-edit-sm" data-type="user" data-id="${u.id}">Editar</button></td></tr>`).join('')}
            </tbody></table>`;
        }
        function renderAdminEmployeeTable() { 
             return `<table class="w-full text-sm table"><tbody>
                ${state.employees.map(e => `<tr><td><div class="font-semibold">${e.name}</div><div class="text-xs text-gray-500">${e.roleTitle}</div></td><td class="text-right space-x-2"><button class="btn-edit-sm" data-type="employee" data-id="${e.id}">Editar</button><button class="btn-danger-sm" data-type="employee" data-id="${e.id}">×</button></td></tr>`).join('')}
            </tbody></table>`;
        }
        function renderAdminContractTable() {
             return `<table class="w-full text-sm table"><tbody>
                ${state.contracts.map(c => `<tr><td><div class="font-semibold">${c.name}</div><div class="text-xs text-gray-500">${formatCurrency(c.value)}</div></td><td class="text-right space-x-2"><button class="btn-edit-sm" data-type="contract" data-id="${c.id}">Editar</button><button class="btn-danger-sm" data-type="contract" data-id="${c.id}">×</button></td></tr>`).join('')}
            </tbody></table>`;
        }
        function renderAdminCommissionModelTable() {
             return `<table class="w-full text-sm table"><tbody>
                ${state.commissionModels.map(t => `<tr><td><div class="font-semibold">${t.name}</div></td><td class="text-right space-x-2"><button class="btn-edit-sm" data-type="commissionModel" data-id="${t.id}">Editar</button><button class="btn-danger-sm" data-type="commissionModel" data-id="${t.id}">×</button></td></tr>`).join('')}
            </tbody></table>`;
        }

        function renderAdminUserForm(item = {}) {
            return `<form class="space-y-2" data-id="${item.id || ''}">
                <input name="name" placeholder="Nome Completo" class="form-input text-sm" value="${item.name || ''}" required>
                <input name="email" type="email" placeholder="Email (para login)" class="form-input text-sm" value="${item.email || ''}" required ${item.id ? 'readonly' : ''}>
                ${!item.id ? `<input name="password" type="password" placeholder="Senha (mín. 6 caracteres)" class="form-input text-sm" required>` : ''}
                <div class="flex gap-4 pt-2"><label class="text-sm flex items-center gap-2"><input type="checkbox" name="isManager" ${item.isManager ? 'checked' : ''}> Gestor</label>
                <label class="text-sm flex items-center gap-2"><input type="checkbox" name="isAdmin" ${item.isAdmin ? 'checked' : ''}> Admin</label></div>
                <button type="submit" class="btn btn-primary text-sm w-full mt-2">Salvar</button>
            </form>`;
        }
        function renderAdminEmployeeForm(item = {}) {
             return `<form class="space-y-2" data-id="${item.id || ''}">
                <input name="name" placeholder="Nome do Funcionário" class="form-input text-sm" value="${item.name || ''}" required>
                <input name="roleTitle" placeholder="Cargo" class="form-input text-sm" value="${item.roleTitle || ''}" required>
                <input name="salary" type="number" step="0.01" placeholder="Salário" class="form-input text-sm" value="${item.salary || ''}" required>
                <input name="admissionDate" type="date" title="Data de Admissão" class="form-input text-sm" value="${item.admissionDate || ''}" required>
                <button type="submit" class="btn btn-primary text-sm w-full">Salvar</button>
            </form>`;
        }
        function renderAdminContractForm(item = {}) {
             const modelOptions = state.commissionModels.map(m => `<option value="${m.id}" ${item.commissionModelId === m.id ? 'selected' : ''}>${m.name}</option>`).join('');
             return `<form class="space-y-2" data-id="${item.id || ''}">
                 <input name="name" placeholder="Nome do Contrato" class="form-input text-sm" value="${item.name || ''}" required>
                 <input name="value" type="number" step="0.01" placeholder="Valor" class="form-input text-sm" value="${item.value || ''}" required>
                 <input name="closingDate" type="date" title="Data de Fechamento" class="form-input text-sm" value="${item.closingDate || ''}" required>
                 <select name="commissionModelId" class="form-input text-sm" required><option value="">Selecione o Modelo de Comissão</option>${modelOptions}</select>
                 <button type="submit" class="btn btn-primary text-sm w-full">Salvar</button>
            </form>`;
        }
        function renderAdminCommissionModelForm(item = {}) {
            let tiersHtml = item.tiers?.map((tier, tierIndex) => `
                <div class="p-2 border rounded mt-2 tier-row">
                    <div class="grid grid-cols-2 lg:grid-cols-3 gap-2">
                        <input name="rangeInf" placeholder="De" class="form-input text-sm" value="${tier.rangeInf}">
                        <input name="rangeSup" placeholder="Até" class="form-input text-sm" value="${tier.rangeSup}">
                        <button type="button" class="btn-danger-sm remove-tier-btn col-span-2 lg:col-span-1">Remover Faixa</button>
                    </div>
                    <div class="mt-2 text-xs font-semibold">Taxas por Funcionário (%):</div>
                    <div class="grid grid-cols-2 gap-x-4 gap-y-2 mt-1">
                        ${state.employees.map(emp => `<label class="text-xs flex items-center justify-between gap-2">${emp.name}
                            <input type="number" step="0.001" name="rate_${emp.id}" class="form-input text-xs w-20" value="${(tier.rates?.[emp.id] || 0) * 100}"></label>`).join('')}
                    </div>
                </div>`).join('') || '';

            return `<form class="space-y-2" data-id="${item.id || ''}">
                 <input name="name" placeholder="Nome do Modelo" class="form-input text-sm" value="${item.name || ''}" required>
                 <div id="tiersContainer">${tiersHtml}</div>
                 <button type="button" id="addTierBtn" class="text-xs text-blue-600 mt-2">+ Adicionar Faixa de Valor</button>
                 <button type="submit" class="btn btn-primary text-sm w-full mt-4">Salvar Modelo</button>
            </form>`;
        }
        
        // --- GESTOR & FUNCIONARIO DASHBOARDS ---
        function renderGestorDashboard() { return renderCalculator('gestor'); }
        function renderFuncionarioDashboard() { return renderCalculator('funcionario'); }

        function renderCalculator(profile) {
            const contractOptions = state.contracts.map(c => `<label class="flex items-center gap-2 text-sm"><input type="checkbox" name="selectedContracts" value="${c.id}">${c.name} (${formatCurrency(c.value)})</label>`).join('');
            const title = profile === 'gestor' ? 'Painel do Gestor' : 'Painel do Funcionário';
            return `${renderHeader(title)}
                    <main class="container mx-auto">
                        <div class="card">
                            <h2 class="text-lg font-semibold mb-4">Calculadora de Bônus</h2>
                            <form id="calculatorForm" data-profile="${profile}">
                                <div class="mb-4">
                                    <label class="font-medium text-sm">Selecione os Contratos para Simular:</label>
                                    <div class="table-container p-2 mt-1 bg-gray-50">${contractOptions}</div>
                                </div>
                                <button type="submit" class="btn btn-primary">Calcular Bônus</button>
                            </form>
                            <div id="bonusResult" class="mt-4"></div>
                        </div>
                    </main>`;
        }
        
        // --- EVENT LISTENERS ---
        function attachEventListeners() {
            appEl.querySelector('#logoutBtn')?.addEventListener('click', () => signOut(auth));
            if (state.currentView === 'login') {
                appEl.querySelector('#loginForm')?.addEventListener('submit', handleLogin);
            } else if (state.currentView === 'admin') {
                appEl.addEventListener('click', handleAdminClicks);
            } else if (state.currentView === 'gestor' || state.currentView === 'funcionario') {
                appEl.querySelector('#calculatorForm')?.addEventListener('submit', handleBonusCalculation);
            }
        }
        
        async function handleLogin(e) {
            e.preventDefault();
            const btn = e.target.querySelector('button[type="submit"]');
            btn.disabled = true;
            btn.innerHTML = `<div class="loader loader-sm mx-auto"></div>`;
            try {
                await signInWithEmailAndPassword(auth, e.target.email.value, e.target.password.value);
            } catch (error) {
                alert("Falha no login: " + error.message);
                btn.disabled = false;
                btn.textContent = 'Entrar';
            }
        }

        function handleAdminClicks(e) {
            if (e.target.matches('.btn-add-item')) {
                const type = e.target.dataset.type;
                const formRenderers = { user: renderAdminUserForm, employee: renderAdminEmployeeForm, contract: renderAdminContractForm, commissionModel: renderAdminCommissionModelForm };
                const titleMap = { user: 'Adicionar Usuário', employee: 'Adicionar Funcionário', contract: 'Adicionar Contrato', commissionModel: 'Adicionar Modelo de Comissão' };
                openModal(titleMap[type], formRenderers[type]());
                attachModalFormListeners(type);
            }
            if (e.target.matches('.btn-edit-sm')) {
                const type = e.target.dataset.type;
                const id = e.target.dataset.id;
                const item = state[`${type}s`].find(i => i.id === id);
                const formRenderers = { user: renderAdminUserForm, employee: renderAdminEmployeeForm, contract: renderAdminContractForm, commissionModel: renderAdminCommissionModelForm };
                const titleMap = { user: 'Editar Usuário', employee: 'Editar Funcionário', contract: 'Editar Contrato', commissionModel: 'Editar Modelo de Comissão' };
                openModal(titleMap[type], formRenderers[type](item));
                attachModalFormListeners(type, id);
            }
            if (e.target.matches('.btn-danger-sm')) {
                const type = e.target.dataset.type;
                const id = e.target.dataset.id;
                if (confirm(`Tem certeza?`)) { deleteDoc(doc(db, `${type}s`, id)); }
            }
        }
        
        function attachModalFormListeners(type, id) {
            const formContainer = document.getElementById('modalFormContainer');
            formContainer.querySelector('form').addEventListener('submit', (e) => handleAdminFormSubmit(e, type, id));
            if (type === 'commissionModel') {
                formContainer.addEventListener('click', e => {
                    if (e.target.id === 'addTierBtn') {
                        const container = document.getElementById('tiersContainer');
                        const newRow = document.createElement('div');
                        newRow.className = 'p-2 border rounded mt-2 tier-row';
                        newRow.innerHTML = renderAdminCommissionModelForm({ tiers:[{}] }).match(/<div class="p-2.*?<\/div>/s)[0];
                        container.appendChild(newRow);
                    }
                    if (e.target.classList.contains('remove-tier-btn')) {
                        e.target.closest('.tier-row').remove();
                    }
                });
            }
        }

        async function handleAdminFormSubmit(e, type, id) {
            e.preventDefault();
            const form = e.target;
            const formData = new FormData(form);
            let data = {};
            
            if (type === 'user') {
                try {
                    data = {
                        name: formData.get('name'), email: formData.get('email'),
                        isManager: form.querySelector('[name="isManager"]').checked,
                        isAdmin: form.querySelector('[name="isAdmin"]').checked,
                        isEmployee: true
                    };
                    if (id) {
                        await setDoc(doc(usersCol, id), data, { merge: true });
                    } else {
                        const password = formData.get('password');
                        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                        await setDoc(doc(usersCol, userCredential.user.uid), data);
                    }
                } catch (error) { alert(`Erro ao salvar usuário: ${error.message}`); }
            } else if (type === 'commissionModel') {
                data.name = formData.get('name');
                data.tiers = [];
                form.querySelectorAll('.tier-row').forEach(row => {
                    const tierData = {
                        rangeInf: parseFloat(row.querySelector('[name="rangeInf"]').value || 0),
                        rangeSup: parseFloat(row.querySelector('[name="rangeSup"]').value || 0),
                        rates: {}
                    };
                    state.employees.forEach(emp => {
                        const rateValue = row.querySelector(`[name="rate_${emp.id}"]`).value;
                        tierData.rates[emp.id] = parseFloat(rateValue || 0) / 100;
                    });
                    data.tiers.push(tierData);
                });
            } else {
                for (let [key, value] of formData.entries()) { data[key] = value; }
                if (type === 'employee') data.salary = parseFloat(data.salary);
                if (type === 'contract') data.value = parseFloat(data.value);
            }

            const collectionRef = collection(db, `${type}s`);
            if (id) await setDoc(doc(collectionRef, id), data, { merge: true });
            else await addDoc(collectionRef, data);
        }
        
        function handleBonusCalculation(e) {
            e.preventDefault();
            const form = e.target;
            const profile = form.dataset.profile;
            const selectedContractIds = Array.from(form.querySelectorAll('[name="selectedContracts"]:checked')).map(el => el.value);
            const selectedContracts = state.contracts.filter(c => selectedContractIds.includes(c.id));
            
            let totalBonus = 0;
            let resultsHtml = '';
            
            selectedContracts.forEach(contract => {
                const commissionModel = state.commissionModels.find(m => m.id === contract.commissionModelId);
                if (!commissionModel) {
                    resultsHtml += `<p class="text-red-500 text-sm">Contrato ${contract.name} não possui modelo de comissão válido.</p>`;
                    return;
                }
                const contractValue = contract.value;
                const tier = commissionModel.tiers.find(t => contractValue >= t.rangeInf && contractValue < t.rangeSup);
                if(!tier) {
                     resultsHtml += `<p class="text-red-500 text-sm">Contrato ${contract.name} não se encaixa em nenhuma faixa de valor.</p>`;
                     return;
                }
                
                resultsHtml += `<div class="mt-4 border-t pt-2"><h4 class="font-semibold">${contract.name} (${formatCurrency(contractValue)})</h4>`;
                
                if (profile === 'gestor') {
                    state.employees.forEach(emp => {
                        const rate = tier.rates[emp.id] || 0;
                        const bonus = contractValue * rate;
                        totalBonus += bonus;
                        resultsHtml += `<p class="text-sm">${emp.name}: ${formatCurrency(bonus)} (${formatPercent(rate)})</p>`;
                    });
                } else if (profile === 'funcionario') {
                    const empProfile = state.employees.find(e => e.id === state.userProfile.employeeId);
                    if(empProfile){
                        const rate = tier.rates[empProfile.id] || 0;
                        const bonus = contractValue * rate;
                        totalBonus += bonus;
                        resultsHtml += `<p class="text-sm">Seu Bônus: ${formatCurrency(bonus)} (${formatPercent(rate)})</p>`;
                    }
                }
                resultsHtml += `</div>`;
            });

            resultsHtml = `<div class="mt-2"><p class="font-bold">Bônus Total da Simulação: ${formatCurrency(totalBonus)}</p></div>` + resultsHtml;
            
            document.getElementById('bonusResult').innerHTML = resultsHtml;
        }
        
        render();
    </script>
</body>
</html>
